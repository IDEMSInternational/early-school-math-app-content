{
  "flow_type": "template",
  "flow_name": "esm_topic_body_template",
  "status": "released",
  "rows": [
    {
      "name": "esm_topic_ptr",
      "exclude_from_translation": true
    },
    {
      "name": "block_chars",
      "value": "block",
      "exclude_from_translation": true
    },
    {
      "name": "chars_type",
      "value": "_type",
      "exclude_from_translation": true
    },
    {
      "name": "chars_accord",
      "value": "_accord",
      "exclude_from_translation": true
    },
    {
      "name": "chars_text",
      "value": "_text",
      "exclude_from_translation": true
    },
    {
      "name": "chars_illust",
      "value": "_illust",
      "exclude_from_translation": true
    },
    {
      "name": "chars_illust_flex",
      "value": "_illust_flex",
      "exclude_from_translation": true
    },
    {
      "name": "chars_illust_max_width",
      "value": "_illust_max_size",
      "exclude_from_translation": true
    },
    {
      "name": "chars_id",
      "value": "id"
    },
    {
      "name": "remove_paragraph_space",
      "value": "margin-top: -5px",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "margin-top: 0px",
      "exclude_from_translation": true
    },
    {
      "type": "begin_items",
      "name": "run_through_body_sections",
      "value": "@data.efm_num_list_one_to_ten",
      "exclude_from_translation": true
    },
    {
      "name": "block_num_chars",
      "value": "@local.block_chars@item.number",
      "exclude_from_translation": true
    },
    {
      "name": "block_type",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_type",
      "exclude_from_translation": true
    },
    {
      "name": "block_text",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_text",
      "exclude_from_translation": true
    },
    {
      "name": "accordion_label",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_accord",
      "exclude_from_translation": true
    },
    {
      "name": "block_illustration",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_illust",
      "exclude_from_translation": true
    },
    {
      "name": "block_illustration_flex",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_illust_flex",
      "exclude_from_translation": true
    },
    {
      "name": "block_illustration_max_width",
      "value": "local.esm_topic_ptr.@local.block_num_chars@local.chars_illust_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"accord_all_text\"",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "margin-top: 0px",
      "exclude_from_translation": true
    },
    {
      "type": "begin_accordion",
      "name": "accordion",
      "parameter_list": "open_multiple:TRUE;",
      "exclude_from_translation": true
    },
    {
      "type": "begin_accordion_section",
      "name": "bloxk_1",
      "value": "@@local.accordion_label",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "exclude_from_translation": true
    },
    {
      "type": "end_accordion_section",
      "exclude_from_translation": true
    },
    {
      "type": "end_accordion",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"accord_illust_below\"",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "margin-top: 0px",
      "exclude_from_translation": true
    },
    {
      "type": "begin_accordion",
      "name": "accordion",
      "parameter_list": "open_multiple:TRUE;",
      "exclude_from_translation": true
    },
    {
      "type": "begin_accordion_section",
      "name": "bloxk_2",
      "value": "@@local.accordion_label",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "text_and_illust_dg",
      "parameter_list": "style: column;"
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "display_illust",
      "value": "@@local.block_illustration",
      "style_list": "margin-top: -5px;\nmax-width: @@local.block_illustration_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group"
    },
    {
      "type": "end_accordion_section",
      "exclude_from_translation": true
    },
    {
      "type": "end_accordion",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"all_text\"",
      "style_list": "@local.paragraph_space; ",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "@local.remove_paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"all_illust\"",
      "parameter_list": "style: column;",
      "style_list": "@local.paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "display_illust",
      "value": "@@local.block_illustration",
      "style_list": "max-width: @@local.block_illustration_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"illust_left\"",
      "style_list": "@local.paragraph_space",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "@local.remove_paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "display_illust",
      "value": "@@local.block_illustration",
      "style_list": "flex: @@local.block_illustration_flex;\nmax-width: @@local.block_illustration_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "style_list": "flex:100",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"illust_right\"",
      "style_list": "@local.paragraph_space",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "@local.remove_paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "style_list": "flex:100",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "display_illust",
      "value": "@@local.block_illustration",
      "style_list": "flex: @@local.block_illustration_flex;\nmax-width: @@local.block_illustration_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"illust_below\"",
      "parameter_list": "style: column;",
      "style_list": "@local.paragraph_space",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "@local.remove_paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "display_text",
      "value": "@@local.block_text",
      "exclude_from_translation": true
    },
    {
      "type": "image",
      "name": "display_illust",
      "value": "@@local.block_illustration",
      "style_list": "margin-top: -5px;\nmax-width: @@local.block_illustration_max_width",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "condition": "@@local.block_type == \"button\"",
      "parameter_list": "style: column;",
      "style_list": "@local.paragraph_space",
      "exclude_from_translation": true
    },
    {
      "name": "paragraph_space",
      "value": "@local.remove_paragraph_space",
      "exclude_from_translation": true
    },
    {
      "type": "button",
      "name": "display_button",
      "value": "@@local.accordion_label",
      "action_list": "click | go_to: @@local.block_text",
      "parameter_list": "style: short; \ntext_align: center",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "end_items",
      "exclude_from_translation": true
    },
    {
      "name": "Commnts_b",
      "value": "Put \"Related Topics\" accordian with Previous and Next Topics if they exist"
    },
    {
      "name": "prev_topic1",
      "value": "local.esm_topic_ptr.prev_topic_1"
    },
    {
      "name": "next_topic1",
      "value": "local.esm_topic_ptr.next_topic_1"
    },
    {
      "type": "begin_display_group",
      "name": "dg_big_accordion",
      "condition": "@@local.prev_topic1 || @@local.next_topic1",
      "parameter_list": "style: column;"
    },
    {
      "type": "begin_accordion",
      "name": "accordion_related_topics",
      "parameter_list": "open_multiple:TRUE;"
    },
    {
      "type": "begin_accordion_section",
      "name": "required_topics_block",
      "value": "Related Topics",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "related_topics_content",
      "parameter_list": "style: column;"
    },
    {
      "type": "begin_display_group",
      "name": "previous_topics_content",
      "condition": "@@local.prev_topic1",
      "parameter_list": "style: column;"
    },
    {
      "type": "text",
      "name": "previous_topics_start",
      "value": "– Previous Topics –"
    },
    {
      "name": "temp_ptr",
      "value": "local.esm_topic_ptr.prev_topic_text"
    },
    {
      "type": "text",
      "name": "previous_topics_intro",
      "value": "@@local.temp_ptr",
      "condition": "@@local.temp_ptr"
    },
    {
      "type": "begin_items",
      "name": "run_through_previous_topics",
      "value": "@data.efm_num_list_one_to_ten"
    },
    {
      "name": "prev_topic_n",
      "value": "local.esm_topic_ptr.prev_topic_@item.number"
    },
    {
      "name": "prev_id",
      "value": "@@local.prev_topic_n"
    },
    {
      "name": "prev_row",
      "value": "data.esm_topics.@local.prev_id",
      "condition": "@local.prev_id"
    },
    {
      "name": "prev_row_ptr",
      "value": "@@local.prev_row",
      "condition": "@local.prev_id"
    },
    {
      "name": "prev_name",
      "value": "@local.prev_row_ptr.name",
      "condition": "@local.prev_id"
    },
    {
      "type": "button",
      "name": "previous_@item.number",
      "value": "@local.prev_name",
      "action_list": "click | set_field:current_topic:@local.prev_row;\nclick | go_to: esm_topic_template;\nclick | emit:force_reload",
      "condition": "@local.prev_id",
      "parameter_list": "style: short;\ntext_align: center"
    },
    {
      "type": "end_items"
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "next_topics_content",
      "condition": "@@local.next_topic1",
      "parameter_list": "style: column;"
    },
    {
      "type": "text",
      "name": "next_topics_start",
      "value": "– Next Topics –"
    },
    {
      "name": "temp_ptr",
      "value": "local.esm_topic_ptr.next_topic_text"
    },
    {
      "type": "text",
      "name": "next_topics_intro",
      "value": "@@local.temp_ptr",
      "condition": "@@local.temp_ptr"
    },
    {
      "type": "begin_items",
      "name": "run_through_next_topics",
      "value": "@data.efm_num_list_one_to_ten"
    },
    {
      "name": "next_topic_n",
      "value": "local.esm_topic_ptr.next_topic_@item.number"
    },
    {
      "name": "next_id",
      "value": "@@local.next_topic_n"
    },
    {
      "name": "next_row",
      "value": "data.esm_topics.@local.next_id",
      "condition": "@local.next_id"
    },
    {
      "name": "next_row_ptr",
      "value": "@@local.next_row",
      "condition": "@local.next_id"
    },
    {
      "name": "next_name",
      "value": "@local.next_row_ptr.name",
      "condition": "@local.next_id"
    },
    {
      "type": "button",
      "name": "next_@item.number",
      "value": "@local.next_name",
      "action_list": "click | set_field:current_topic:@local.next_row;\nclick | go_to: esm_topic_template;\nclick | emit:force_reload",
      "condition": "@local.next_id",
      "parameter_list": "style: short;\ntext_align: center"
    },
    {
      "type": "end_items"
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "end_accordion_section",
      "exclude_from_translation": true
    },
    {
      "type": "end_accordion"
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "name": "Comments_a",
      "value": "Put \"Resources\" and \"Glossary\" buttons at bottom of page"
    },
    {
      "type": "begin_display_group",
      "name": "dg_find_resources"
    },
    {
      "name": "topic_id_ptr",
      "value": "local.esm_topic_ptr.@local.chars_id"
    },
    {
      "name": "topic_id",
      "value": "@@local.topic_id_ptr"
    },
    {
      "name": "glossary_count_ptr",
      "value": "local.esm_topic_ptr.glossary_count"
    },
    {
      "name": "glossary_word_1_ptr",
      "value": "local.esm_topic_ptr.glossary_1"
    },
    {
      "name": "glossary_word_2_ptr",
      "value": "local.esm_topic_ptr.glossary_2"
    },
    {
      "name": "glossary_word_3_ptr",
      "value": "local.esm_topic_ptr.glossary_3"
    },
    {
      "name": "glossary_word_4_ptr",
      "value": "local.esm_topic_ptr.glossary_4"
    },
    {
      "name": "glossary_word_5_ptr",
      "value": "local.esm_topic_ptr.glossary_5"
    },
    {
      "name": "glossary_word_6_ptr",
      "value": "local.esm_topic_ptr.glossary_6"
    },
    {
      "name": "EmPtY_string",
      "value": "EmPtY"
    },
    {
      "type": "button",
      "name": "button_resources",
      "value": "Resources",
      "action_list": "click | set_field:topics_search_set: @local.topic_id;\nclick | go_to: esm_resources_finder;",
      "parameter_list": "style: short;\ntext_align: center",
      "comments": "click | @calc(@fields.topics_search_set.add(@local.topic_id));"
    },
    {
      "type": "text",
      "name": "spacer",
      "style_list": "flex:1"
    },
    {
      "type": "button",
      "name": "button_glossary",
      "value": "Glossary",
      "action_list": "click | set_field:glossary_words_count : @@local.glossary_count_ptr; \nclick | set_field:glossary_word_1 : @@local.glossary_word_1_ptr; \nclick | set_field:glossary_word_2 : @@local.glossary_word_2_ptr; \nclick | set_field:glossary_word_3 : @@local.glossary_word_3_ptr; \nclick | set_field:glossary_word_4 : @@local.glossary_word_4_ptr; \nclick | set_field:glossary_word_5 : @@local.glossary_word_5_ptr; \nclick | set_field:glossary_word_6 : @@local.glossary_word_6_ptr; \nclick | go_to: efm_gloss_start;",
      "parameter_list": "style: short;\ntext_align: center"
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    }
  ]
}